!function(t,e,i,n){var a=function(e,i){this.elem=e,this.$elem=t(e),this.options=i,this.metadata=this.$elem.data("plugin-options")};a.defaults=(a.prototype={public:function(){return{startDate:moment(),endDate:moment(),format:"L LT",dateSeparator:" - ",calendarCount:2,mobileBreakpoint:760,isHotelBooking:!1,inline:!1,minDate:null,maxDate:null,showHeader:!0,showFooter:!0,rangeOrientation:"horizontal",verticalRangeWidth:180,showTimePickers:!0,showCalendars:!0,showButtons:!1,hourFormat:12,minuteSteps:1,startOnMonday:!1,container:"body",oneCalendarWidth:230,enableKeyboard:!0,showOn:"bottom",arrowOn:"left",autoAlign:!0,locale:moment.locale(),singleDate:!1,target:null,autoCloseOnSelect:!1,startEmpty:!1,ranges:[{title:"Today",startDate:moment().startOf("day"),endDate:moment().endOf("day")},{title:"3 Days",startDate:moment().startOf("day"),endDate:moment().add(2,"days").endOf("day")},{title:"5 Days",startDate:moment().startOf("day"),endDate:moment().add(4,"days").endOf("day")},{title:"1 Week",startDate:moment().startOf("day"),endDate:moment().add(6,"days").endOf("day")},{title:"Till Next Week",startDate:moment().startOf("day"),endDate:moment().endOf("week").endOf("day")},{title:"Till Next Month",startDate:moment().startOf("day"),endDate:moment().endOf("month").endOf("day")}],rangeLabel:"Ranges: ",cancelLabel:"Cancel",applyLabel:"Apply",nextMonthIcon:"<i class='fa fa-arrow-right'></i>",prevMonthIcon:"<i class='fa fa-arrow-left'></i>",rangeIcon:"<i class='fa fa-retweet'></i>",headerSeparator:"<i class='fa fa-chevron-right'></i>",onbeforeselect:function(){return!0},onCancel:function(){return!0},onafterselect:function(){},onbeforeshow:function(){},onbeforehide:function(){},onaftershow:function(){},onafterhide:function(){},onfirstselect:function(){},onrangeselect:function(){},onbeforemonthchange:function(){return!0},onaftermonthchange:function(){},onafteryearchange:function(){},ondraw:function(){},onBeforeInit:function(){},onBeforeDestroy:function(){return!0},ondestroy:function(){},validateClick:function(){return!0},oninit:function(){},ontimechange:function(){},disableDays:function(){return!1},limitTimeForDay:function(){return{start:{hour:0,minute:0,ampm:null},end:{hour:23,minute:59,ampm:null}}},disabledRanges:[],continuous:!1,disableOnlyStart:!1,disableOnlyEnd:!1,minSelectedDays:0,enableMonthSwitcher:!0,monthSwitcherFormat:"MMMM",enableYearSwitcher:!0,enableSwipe:!0,numericMonthSelector:!1,reverseTimepickerArrows:!1,showWeekNumbers:!1,hideOutOfRange:!1,DOBCalendar:!1,isRTL:!1}},private:function(){return{startSelected:!1,currentDate:moment(),endSelected:!0,hoverDate:null,keyboardHoverDate:null,headerStartDay:null,headerStartDate:null,headerStartWeekday:null,headerEndDay:null,headerEndDate:null,headerEndWeekday:null,swipeTimeout:null,isMobile:!1,valElements:["BUTTON","OPTION","INPUT","LI","METER","PROGRESS","PARAM"],dontHideOnce:!1,initiator:null,initComplete:!1,startDateBackup:null,firstValueSelected:!1,startDateInitial:null,endDateInitial:null,startScrolling:!1,lastScrollDirection:"bottom",throttleTimeout:null,documentEvent:null,delayInputUpdate:!1,startTimeBackup:null,endTimeBackup:null,mouseTimer:!1,preventMouseClick:!1,lastScrollX:0,lastScrollY:0,isTicking:!1,parentScrollEventsAttached:!1,rafID:0,disabledDays:{},skipTabKeyOnInput:!1}},init:function(){return this.config=t.extend({},this.public(),this.options,this.metadata),this.globals=t.extend({},this.private()),this.globals.isMobile=this.checkMobile(),t("body").addClass(this.checkTouch()?"calentim-touch":"calentim-notouch"),this.config.onBeforeInit(this),this.applyConfig(),this.fetchInputs(),(!1===this.config.startEmpty||this.globals.firstValueSelected)&&(this.globals.currentDate=moment(this.config.startDate)),this.drawUserInterface(),this.addInitialEvents(),this.$elem.data("calentim",this),this.config.oninit(this),this.globals.initComplete=!0,this.globals.lastScrollX=e.scrollX||e.pageXOffset||i.documentElement.scrollLeft,this.globals.lastScrollY=e.scrollY||e.pageYOffset||i.documentElement.scrollTop,t(e).trigger("resize.calentim"),this},validateDates:function(){if(null!==this.config.startDate&&null!==this.config.endDate){var t=moment(this.config.startDate,this.config.format).locale(this.config.locale),e=moment(this.config.endDate,this.config.format).locale(this.config.locale),i=moment().locale(this.config.locale);!1===this.config.singleDate?(t.isValid()&&e.isValid()?t.isBefore(e)?(this.config.startDate=t.clone(),this.config.endDate=e.clone()):(this.config.startDate=e.clone(),this.config.endDate=t.clone()):(this.config.startDate=i.clone(),this.config.endDate=i.clone()),this.config.startDate=this.TimeInsideLimits(this.config.startDate,"start"),this.config.endDate=this.TimeInsideLimits(this.config.endDate,"end")):(!1===t.isValid()?this.config.startDate=i.clone():this.config.startDate=t.clone(),this.config.startDate=this.TimeInsideLimits(this.config.startDate,"start"));var n=null,a=null;null!==this.config.minDate&&((n=moment(this.config.minDate,this.config.format).locale(this.config.locale)).isValid()?this.config.minDate=n.clone():(this.config.minDate=null,n=null)),null!==this.config.maxDate&&((a=moment(this.config.maxDate,this.config.format).locale(this.config.locale)).isValid()?n?n.isBefore(a)?this.config.maxDate=a.clone():(this.config.minDate=a.clone(),this.config.maxDate=n.clone()):this.config.maxDate=a.clone():(this.config.maxDate=null,a=null)),n&&t&&n.isAfter(t,"day")&&(this.config.startDate=n.clone()),n&&e&&n.isAfter(e,"day")&&(this.config.endDate=n.clone()),a&&t&&a.isBefore(t,"day")&&(this.config.startDate=a.clone()),null!==a&&null!==e&&a.isBefore(e,"day")&&(this.config.endDate=a.clone()),(!1===this.checkRangeContinuity()||1==this.config.disableOnlyStart&&this.isDisabled(this.config.startDate,this.config.isHotelBooking)||!1===this.config.singleDate&&this.config.disableOnlyEnd&&this.isDisabled(this.config.endDate,this.config.isHotelBooking)||this.config.startEmpty&&0==this.globals.firstValueSelected)&&this.clearInput()}},applyConfig:function(){null===this.config.target&&(this.config.target=this.$elem),!0===this.config.inline&&(this.config.DOBCalendar=!1),1==this.config.DOBCalendar&&(this.config.singleDate=!0),["startDate","endDate","minDate","maxDate"].forEach(function(t){this.config[t]=this.fixDateTime(this.config[t])},this),this.config.ranges.map(function(t){return t.startDate=this.fixDateTime(t.startDate),t.endDate=this.fixDateTime(t.endDate),t},this),!1===this.globals.isMobile?(!0===this.config.inline?(this.container=this.$elem.wrapAll("<div class='calentim-container calentim-inline' onclick=''></div>").parent(),this.input=t("<div class='calentim-input'></div>").appendTo(this.container),this.elem.type="hidden",this.config.showButtons=!1,this.setViewport()):(this.container=t("<div class='calentim-container calentim-popup' style='display: none;' onclick=''><div class='calentim-box-arrow-top'></div></div>").appendTo(this.config.container),this.input=t("<div class='calentim-input'></div>").appendTo(this.container),this.config.showButtons&&(this.globals.delayInputUpdate=!0,this.config.autoCloseOnSelect=!1)),"horizontal"===this.config.rangeOrientation?this.input.css("width",this.config.calendarCount*this.config.oneCalendarWidth+"px"):this.input.css("width",this.config.calendarCount*this.config.oneCalendarWidth+this.config.verticalRangeWidth+"px")):(!0===this.config.inline?(this.container=this.$elem.wrapAll("<div class='calentim-container-mobile calentim-inline' onclick=''></div>").parent(),this.input=t("<div class='calentim-input'></div>").appendTo(this.container),this.elem.type="hidden",this.config.showButtons=!1):(this.container=t("<div class='calentim-container-mobile' onclick=''></div>").appendTo(this.config.container),this.input=t("<div class='calentim-input' style='display: none;'></div>").appendTo(this.container),0===t("body > .calentim-overlay").length?(this.overlay=t("<div class='calentim-overlay' style='display: none'></div>").appendTo("body"),this.overlay.on("click.calentim tap.calentim",function(){var e=t("body > .calentim-container-mobile");e.length>0&&e.each(function(){"none"!=t(this).css("display")&&t(this).find(".calentim-cancel").click()})})):this.overlay=t("body > .calentim-overlay").first(),this.config.showButtons&&(this.config.autoCloseOnSelect=!1),this.config.autoCloseOnSelect||(this.globals.delayInputUpdate=!0)),this.$elem.on("focus",function(){t(this).blur()})),this.config.isHotelBooking&&this.container.addClass("calentim-hotel-style"),this.container.data("calentim",this),this.clearRangeSelection()},clearRangeSelection:function(){for(var e=0;e<this.config.ranges.length;e++)this.config.ranges[e].selected=!1;this.container.find(".calentim-range").each(function(){t(this).removeClass("calentim-range-selected")})},fetchInputs:function(){var e=null;if(e=-1!==t.inArray(this.config.target.get(0).tagName,this.globals.valElements)?this.config.target.val():this.config.target.text(),!1===this.config.singleDate&&e.indexOf(this.config.dateSeparator)>0&&""!==e){var i=e.split(this.config.dateSeparator);if(2==i.length&&moment(i[0],this.config.format,this.config.locale).isValid()&&moment(i[1],this.config.format,this.config.locale).isValid()){var n=null;this.config.showCalendars&&(moment.isMoment(this.config.startDate)?(n=moment(i[0],this.config.format,this.config.locale),this.config.startDate.year(n.year()).month(n.month()).date(n.date())):this.config.startDate=moment(i[0],this.config.format,this.config.locale),moment.isMoment(this.config.endDate)?(n=moment(i[1],this.config.format,this.config.locale),this.config.endDate.year(n.year()).month(n.month()).date(n.date())):this.config.endDate=moment(i[1],this.config.format,this.config.locale)),this.config.showTimePickers&&(moment.isMoment(this.config.startDate)?(n=moment(i[0],this.config.format,this.config.locale),this.config.startDate.hour(n.hour()).minute(n.minute()).seconds(n.seconds())):this.config.startDate=moment(i[0],this.config.format,this.config.locale),moment.isMoment(this.config.endDate)?(n=moment(i[1],this.config.format,this.config.locale),this.config.endDate.hour(n.hour()).minute(n.minute()).seconds(n.seconds())):this.config.endDate=moment(i[1],this.config.format,this.config.locale)),this.globals.firstValueSelected=!0}}else if(!0===this.config.singleDate){var a=e;""!==a&&moment(a,this.config.format,this.config.locale).isValid()&&(this.config.startDate=moment(a,this.config.format,this.config.locale),this.config.endDate=moment(a,this.config.format,this.config.locale),this.globals.firstValueSelected=!0)}this.config.startEmpty&&!this.globals.firstValueSelected&&this.clearInput(),this.validateDates(),this.updateTimePickerDisplay()},drawUserInterface:function(){if(this.drawHeader(),this.calendars=this.input.find(".calentim-calendars").first(),!0===this.config.showCalendars){var t=this.globals.currentDate.clone().middleOfDay();this.globals.disabledDays={};for(var e=0;e<this.config.calendarCount;e++)this.drawCalendarOfMonth(t),t=t.month(t.month()+1);this.calendars.find(".calentim-calendar").last().addClass("no-border-right"),this.drawArrows()}else this.calendars.hide(),this.container.addClass("calentim-hidden-calendar");if(this.drawTimePickers(),this.addKeyboardEvents(),this.drawFooter(),this.reDrawCells(),this.globals.initComplete&&this.setViewport(),this.config.isRTL&&(this.container.css("direction","rtl"),this.container.addClass("calentim-rtl")),!1===this.globals.startSelected)if(this.globals.initComplete)this.updateInput(!1,!1);else{var i=this.globals.delayInputUpdate;this.globals.delayInputUpdate=!1,this.updateInput(!1,!1),this.globals.delayInputUpdate=i}},drawHeader:function(){var t="<div class='calentim-header'><div class='calentim-header-start'><div class='calentim-header-start-day'></div><div class='calentim-header-start-date'></div><div class='calentim-header-start-weekday'></div></div>";!1===this.config.singleDate&&(t+="<div class='calentim-header-separator'>"+this.config.headerSeparator+"</div><div class='calentim-header-end'><div class='calentim-header-end-day'></div><div class='calentim-header-end-date'></div><div class='calentim-header-end-weekday'></div></div>"),t+="</div><div class='calentim-calendars' tabindex='0'></div>",this.input.append(t),!1!==this.config.showHeader&&!1!==this.config.showCalendars||this.input.find(".calentim-header").hide(),this.globals.headerStartDay=this.input.find(".calentim-header-start-day"),this.globals.headerStartDate=this.input.find(".calentim-header-start-date"),this.globals.headerStartWeekday=this.input.find(".calentim-header-start-weekday"),this.globals.headerEndDay=this.input.find(".calentim-header-end-day"),this.globals.headerEndDate=this.input.find(".calentim-header-end-date"),this.globals.headerEndWeekday=this.input.find(".calentim-header-end-weekday"),this.updateHeader()},updateHeader:function(){null!==this.config.startDate?(this.config.startDate.locale(this.config.locale),this.globals.headerStartDay.text(this.localizeNumbers(this.config.startDate.date())),this.globals.isMobile?this.globals.headerStartDate.text(this.config.startDate.format("MMM")+" "+this.localizeNumbers(this.config.startDate.year())):this.globals.headerStartDate.text(this.config.startDate.format("MMMM")+" "+this.localizeNumbers(this.config.startDate.year())),this.globals.headerStartWeekday.text(this.config.startDate.format("dddd"))):(this.globals.headerStartDay.text(""),this.globals.headerStartDate.text(""),this.globals.headerStartWeekday.text("")),!1===this.config.singleDate&&(null!==this.config.endDate?(this.config.endDate.locale(this.config.locale),this.globals.headerEndDay.text(this.localizeNumbers(this.config.endDate.date())),this.globals.isMobile?this.globals.headerEndDate.text(this.config.endDate.format("MMM")+" "+this.localizeNumbers(this.config.endDate.year())):this.globals.headerEndDate.text(this.config.endDate.format("MMMM")+" "+this.localizeNumbers(this.config.endDate.year())),this.globals.headerEndWeekday.text(this.config.endDate.format("dddd"))):(this.globals.headerEndDay.text(""),this.globals.headerEndDate.text(""),this.globals.headerEndWeekday.text("")))},isUpdateable:function(){var t=this.globals.delayInputUpdate,e=this.config.startEmpty&&!this.globals.firstValueSelected;return(e=(e=e||!0===this.config.singleDate&&null===this.config.startDate)||!1===this.config.singleDate&&(null===this.config.startDate||!1===this.globals.startSelected&&null===this.config.endDate))&&this.clearInput(),!e&&!t},updateInput:function(e,i){this.isUpdateable()&&(this.readTimeFromDisplay(!1),this.config.startDate&&this.config.endDate&&(this.config.startDate.locale(this.config.locale),this.config.endDate.locale(this.config.locale),-1!==t.inArray(this.config.target.get(0).tagName,this.globals.valElements)?!1===this.config.singleDate?this.config.target.val(this.config.startDate.format(this.config.format)+this.config.dateSeparator+this.config.endDate.format(this.config.format)):this.config.target.val(this.config.startDate.format(this.config.format)):!1===this.config.singleDate?this.config.target.text(this.config.startDate.format(this.config.format)+this.config.dateSeparator+this.config.endDate.format(this.config.format)):this.config.target.text(this.config.startDate.format(this.config.format)),this.globals.initComplete&&(i?this.config.ontimechange(this,this.config.startDate?this.config.startDate.clone():null,this.config.endDate?this.config.endDate.clone():null):e&&this.config.onafterselect(this,this.config.startDate?this.config.startDate.clone():null,this.config.endDate?this.config.endDate.clone():null),this.input.trigger("change"))))},clearInput:function(e){if(-1!==t.inArray(this.config.target.get(0).tagName,this.globals.valElements)?(this.config.singleDate,this.config.target.val("")):(this.config.singleDate,this.config.target.text("")),this.config.startDate=null,this.config.endDate=null,this.globals.startDateInitial=null,this.globals.endDateInitial=null,e?(this.config.startEmpty=!0,this.globals.firstValueSelected=!1):1==this.config.startEmpty&&(this.globals.firstValueSelected=!1),this.globals.initComplete){this.updateHeader();var i=void 0===this.footer?[]:this.footer.find(".calentim-apply");i.length>0&&i.attr("disabled","disabled")}},drawArrows:function(){var t=this.config.hideOutOfRange&&this.config.minDate&&this.globals.currentDate.clone().add(-1,"month").isBefore(this.config.minDate,"month"),e=this.config.hideOutOfRange&&this.config.maxDate&&this.globals.currentDate.clone().add(this.config.calendarCount,"month").isAfter(this.config.maxDate,"month");this.container.find(".calentim-title").length>0&&(this.globals.isMobile?(t||this.container.find(".calentim-title").prepend("<div class='calentim-prev'>"+this.config.prevMonthIcon+"</div>"),e||this.container.find(".calentim-title").append("<div class='calentim-next'>"+this.config.nextMonthIcon+"</div>")):(t||this.container.find(".calentim-title").first().prepend("<div class='calentim-prev'>"+this.config.prevMonthIcon+"</div>"),e||this.container.find(".calentim-title").last().append("<div class='calentim-next'>"+this.config.nextMonthIcon+"</div>")))},drawCalendarOfMonth:function(t){t.locale(this.config.locale);var e=moment(t).locale(this.config.locale).startOf("month").startOf("isoweek").middleOfDay(),i=e.day();1==i&&!1===this.config.startOnMonday?(e.subtract(1,"days"),i=0):0===i&&!0===this.config.startOnMonday&&(e.add(1,"days"),i=1),e.isAfter(moment(t).date(1))&&e.add(-7,"day");var n="<div class='calentim-calendar"+(this.config.showWeekNumbers?" calentim-calendar-weeknumbers":"")+"' data-month='"+t.month()+"'>",a=0,s="",o="";this.config.enableMonthSwitcher&&(s=" class='calentim-month-switch'"),this.config.enableYearSwitcher&&(o=" class='calentim-year-switch'"),n+="<div class='calentim-title'><span><b"+s+">"+t.format("MMMM")+"</b>&nbsp;<span"+o+">"+this.localizeNumbers(t.year())+"</span></span></div>",n+="<div class='calentim-days-container'>",this.config.showWeekNumbers&&(n+="<div class='calentim-dayofweek'>&nbsp;</div>");for(var l=i;l<i+7;l++)n+="<div class='calentim-dayofweek'>"+moment().day(l%7).locale(this.config.locale).format("ddd")+"</div>";for(var r=e.clone().add(-24,"hours").middleOfDay(),c=r.unix(),h=this.isDisabledOnDraw(r);a<42;){var d=e.middleOfDay().unix(),m=t.month()==e.month()?"calentim-day":"calentim-disabled";a%7==0&&this.config.showWeekNumbers&&(n+="<div class='calentim-weeknumber'><span>"+e.format("ww")+"</span></div>"),n+="<div class='"+m+"' data-value='"+d+"'><span>"+this.localizeNumbers(e.date())+"</span></div>",this.isDisabledOnDraw(e)?(this.globals.disabledDays[d]=1==h?2:1,h=!0,c=d):(1==h&&null!=c&&(this.globals.disabledDays[c]=3),h=!1),e.add(moment.duration({days:1})),a++}n+="</div>",n+="</div>",this.calendars.append(n)},drawTimePickers:function(){this.input.find(".calentim-timepickers").remove(),this.input.append("<div class='calentim-timepickers'></div>"),this.timepickers=this.input.find(".calentim-timepickers"),this.config.showTimePickers||this.timepickers.hide();var e=0,i=23,n=!1;12==this.config.hourFormat&&(e=1,i=12,n=!0);var a=t("<div class='calentim-timepicker calentim-timepicker-start'></div>").appendTo(this.timepickers);this.addTimePickerHours(a,e,i),this.addTimePickerHourMinuteSeparator(a),this.addTimePickerMinutes(a,this.config.minuteSteps,0,59),n&&this.addTimePickerAMPM(a),!1===this.config.singleDate&&(a=t("<div class='calentim-timepicker calentim-timepicker-end'></div>").appendTo(this.timepickers),this.addTimePickerHours(a,e,i),this.addTimePickerHourMinuteSeparator(a),this.addTimePickerMinutes(a,this.config.minuteSteps,0,59),n&&this.addTimePickerAMPM(a)),this.addTimePickerEvents(),this.updateTimePickerDisplay()},addTimePickerHours:function(e,i,n){e[0].classList.contains("calentim-timepicker-start");var a=t("<div class='calentim-timepicker-hours-wrapper' tabindex='0'></div>").appendTo(e),s=t("<div class='calentim-timepicker-hours'></div>").appendTo(a),o="<div class='calentim-hour-selected-prev'>&nbsp;</div>";o+="<div class='calentim-hour-selected'>"+("00"+i).slice(-2)+"</div>",o+="<div class='calentim-hour-selected-next'>"+("00"+(i+1)).slice(-2)+"</div>",s.append(o).data({value:i,min:i,max:n,step:1}),t("<div class='calentim-timepicker-hour-arrows'><div class='calentim-timepicker-hours-up "+(this.config.reverseTimepickerArrows?"calentim-direction-down":"calentim-direction-up")+"'><i class='fa fa-arrow-up'></i></div><div class='calentim-timepicker-hours-down "+(this.config.reverseTimepickerArrows?"calentim-direction-up":"calentim-direction-down")+"'><i class='fa fa-arrow-down'></i></div></div>").appendTo(e)},addTimePickerMinutes:function(e,i,n,a){e[0].classList.contains("calentim-timepicker-start");var s=t("<div class='calentim-timepicker-minutes-wrapper' tabindex='0'></div>").appendTo(e);t("<div class='calentim-timepicker-minutes'></div>").appendTo(s).append("<div class='calentim-minute-selected-prev'>&nbsp;</div><div class='calentim-minute-selected'>00</div><div class='calentim-minute-selected-next'>01</divided>").data({value:n,min:n,max:a%i!=0?a-a%i:a,step:i}),t("<div class='calentim-timepicker-minute-arrows'><div class='calentim-timepicker-minutes-up "+(this.config.reverseTimepickerArrows?"calentim-direction-down":"calentim-direction-up")+"'><i class='fa fa-arrow-up'></i></div><div class='calentim-timepicker-minutes-down "+(this.config.reverseTimepickerArrows?"calentim-direction-up":"calentim-direction-down")+"'><i class='fa fa-arrow-down'></i></div></div>").appendTo(e)},addTimePickerHourMinuteSeparator:function(e){t("<div class='calentim-hour-minute-seperator'>:</div>").appendTo(e)},addTimePickerAMPM:function(e){e[0].classList.contains("calentim-timepicker-start");var i=t("<div class='calentim-timepicker-ampm' tabindex='0'></div>").appendTo(e);i.append("<div class='calentim-timepicker-ampm-am'>"+this.localizeAMPM("AM")+"</div>"),i.append("<div class='calentim-timepicker-ampm-pm'>"+this.localizeAMPM("PM")+"</div>")},addTimePickerEvents:function(){var e=this,n=function(t){var e=t.parents(".calentim-container, .calentim-container-mobile").first().data("calentim"),i=t.parents(".calentim-timepicker").attr("class"),n=t.attr("class"),a=i.indexOf("calentim-timepicker-start")>=0?"start":"end",s=n.indexOf("timepicker-minutes")>0?"minute":"hour",o=n.indexOf("calentim-direction-up")>=0?"up":"down";if(null!==e.config[a+"Date"]){var l="hour"==s?1:e.config.minuteSteps,r=e.config[a+"Date"],c=r.clone().add(!1===e.config.reverseTimepickerArrows?"up"==o?-1*l:l:"down"==o?l:-1*l,s);c.set({date:r.date(),month:r.month(),year:r.year()});var h=e.TimeInsideLimits(c,r);e.config[a+"Date"]=h.clone(),e.updateTimePickerDisplay(),e.updateInput(!1,!0)}};t(i).off("mousedown.calentim").on("mousedown.calentim",".calentim-timepicker-minutes-up, .calentim-timepicker-minutes-down, .calentim-timepicker-hours-up, .calentim-timepicker-hours-down",function(i){var a=this;e.globals.mouseTimer&&clearInterval(e.globals.mouseTimer),n(t(a)),e.globals.mouseTimer=setInterval(function(){n(t(a))},200)}).off("mouseup.calentim").on("mouseup.calentim",function(t){e.globals.mouseTimer&&clearInterval(e.globals.mouseTimer),e.globals.preventMouseClick=!0}).off("click.calentim").on("click.calentim",".calentim-timepicker-minutes-up, .calentim-timepicker-minutes-down, .calentim-timepicker-hours-up, .calentim-timepicker-hours-down",function(i){e.globals.preventMouseClick||n(t(this)),e.globals.preventMouseClick=!1}),this.timepickers.find(".calentim-timepicker-hours-wrapper, .calentim-timepicker-minutes-wrapper").off("mousewheel.calentim DOMMouseScroll.calentim").on("mousewheel.calentim DOMMouseScroll.calentim",function(i){(i.originalEvent.wheelDelta||-i.originalEvent.detail)/120>0?t(i.currentTarget).hasClass("calentim-timepicker-hours-wrapper")?n(t(this).siblings(".calentim-timepicker-hour-arrows").find(".calentim-timepicker-hours-up")):t(i.currentTarget).hasClass("calentim-timepicker-minutes-wrapper")&&n(t(this).siblings(".calentim-timepicker-minute-arrows").find(".calentim-timepicker-minutes-up")):t(i.currentTarget).hasClass("calentim-timepicker-hours-wrapper")?n(t(this).siblings(".calentim-timepicker-hour-arrows").find(".calentim-timepicker-hours-down")):t(i.currentTarget).hasClass("calentim-timepicker-minutes-wrapper")&&n(t(this).siblings(".calentim-timepicker-minute-arrows").find(".calentim-timepicker-minutes-down")),e.stopBubbling(i)}),this.globals.isMobile&&this.timepickers.find(".calentim-timepicker-minutes, .calentim-timepicker-hours").each(function(){var i=new Hammer(this);i.get("pan").set({direction:Hammer.DIRECTION_VERTICAL}),i.on("panmove",e.panThrottle(function(i){var a=t(i.target);return i.velocityY>0?a.hasClass("calentim-timepicker-hours-wrapper")||a.parents(".calentim-timepicker-hours-wrapper").length>0?(n(a.parents(".calentim-timepicker").find(".calentim-timepicker-hours-up")),e.stopBubbling(i.srcEvent)):(a.hasClass("calentim-timepicker-minutes-wrapper")||a.parents(".calentim-timepicker-minutes-wrapper").length>0)&&(n(a.parents(".calentim-timepicker").find(".calentim-timepicker-minutes-up")),e.stopBubbling(i.srcEvent)):a.hasClass("calentim-timepicker-hours-wrapper")||a.parents(".calentim-timepicker-hours-wrapper").length>0?(n(a.parents(".calentim-timepicker").find(".calentim-timepicker-hours-down")),e.stopBubbling(i.srcEvent)):(a.hasClass("calentim-timepicker-minutes-wrapper")||a.parents(".calentim-timepicker-minutes-wrapper").length>0)&&(n(a.parents(".calentim-timepicker").find(".calentim-timepicker-minutes-down")),e.stopBubbling(i.srcEvent)),!1}))}),this.timepickers.find(".calentim-timepicker-ampm > div").off("click.calentim").on("click.calentim",function(){var i;if(t(this).hasClass("calentim-ampm-selected"))return!1;t(this).addClass("calentim-ampm-selected").siblings().removeClass("calentim-ampm-selected"),e.updateInput(!1,!1),e.config.startDate&&(i=e.config.startDate.clone(),e.config.startDate=e.TimeInsideLimits(e.config.startDate,"start"),!1===e.config.startDate.isSame(i)&&e.updateTimePickerDisplay()),e.config.endDate&&(i=e.config.endDate.clone(),e.config.endDate=e.TimeInsideLimits(e.config.endDate,"end"),!1===e.config.endDate.isSame(i)&&e.updateTimePickerDisplay()),e.updateInput(!1,!0),e.config.ondraw(e)})},panThrottle:function(e){return t.proxy(function(){var t=Array.prototype.slice.call(arguments),i=Math.ceil(Math.abs(t[0].deltaY)/20)||1;this.globals.panScrollPos!=i&&(e.apply(this,t),this.globals.panScrollPos=i)},this)},readTimeFromDisplay:function(t){var e=null,i=null,n="",a="";12==this.config.hourFormat?(n=this.timepickers.find(".calentim-timepicker-start .calentim-hour-selected").text()+" "+this.timepickers.find(".calentim-timepicker-start .calentim-minute-selected").text()+" "+this.timepickers.find(".calentim-timepicker-start .calentim-ampm-selected").text(),e=moment(n,"hh mm a",this.config.locale),!1===this.config.singleDate&&(a=this.timepickers.find(".calentim-timepicker-end .calentim-hour-selected").text()+" "+this.timepickers.find(".calentim-timepicker-end .calentim-minute-selected").text()+" "+this.timepickers.find(".calentim-timepicker-end .calentim-ampm-selected").text(),i=moment(a,"hh mm a",this.config.locale))):(n=this.timepickers.find(".calentim-timepicker-start .calentim-hour-selected").text()+" "+this.timepickers.find(".calentim-timepicker-start .calentim-minute-selected").text(),e=moment(n,"HH mm",this.config.locale),!1===this.config.singleDate&&(a=this.timepickers.find(".calentim-timepicker-end .calentim-hour-selected").text()+" "+this.timepickers.find(".calentim-timepicker-end .calentim-minute-selected").text(),i=moment(a,"HH mm",this.config.locale))),e.isValid()&&null!==this.config.startDate&&this.config.startDate.hours(e.hours()).minutes(e.minutes()).locale(this.config.locale),!1===this.config.singleDate&&i.isValid()&&null!==this.config.endDate&&this.config.endDate.hours(i.hours()).minutes(i.minutes()).locale(this.config.locale),t&&(e&&(this.globals.startTimeBackup=e.clone()),i&&!1===this.config.singleDate&&(this.globals.endTimeBackup=i.clone()))},backupTimePickers:function(){this.readTimeFromDisplay(!0)},restoreTimePickers:function(){12==this.config.hourFormat?(this.globals.startTimeBackup&&this.setStartTimeValue(parseInt(this.globals.startTimeBackup.clone().locale("en").format("hh"),10),parseInt(this.globals.startTimeBackup.clone().locale("en").format("mm"),10),this.globals.startTimeBackup.clone().locale("en").format("a")),!this.config.singleDate&&this.globals.endTimeBackup&&this.setEndTimeValue(parseInt(this.globals.endTimeBackup.clone().locale("en").format("hh"),10),parseInt(this.globals.endTimeBackup.clone().locale("en").format("mm"),10),this.globals.endTimeBackup.clone().locale("en").format("a"))):(this.globals.startTimeBackup&&this.setStartTimeValue(parseInt(this.globals.startTimeBackup.clone().locale("en").format("HH"),10),parseInt(this.globals.startTimeBackup.clone().locale("en").format("mm"),10),null),!this.config.singleDate&&this.globals.endTimeBackup&&this.setEndTimeValue(parseInt(this.globals.endTimeBackup.clone().locale("en").format("HH"),10),parseInt(this.globals.endTimeBackup.clone().locale("en").format("mm"),10),null))},updateTimePickerDisplay:function(){if(void 0!==this.timepickers){if(null!==this.config.startDate){var t=this.config.startDate.clone().locale("en").set({minute:1!=this.config.minuteSteps?Math.round(this.config.startDate.minutes()/this.config.minuteSteps)*this.config.minuteSteps:this.config.startDate.minutes()}),e=t.hours(),i=t.minutes(),n=null;if(12==this.config.hourFormat){var a=t.format("hh mm a").split(" ");e=parseInt(a[0],10),n=a[2].toLowerCase()}this.setStartTimeValue(e,i,n)}if(null!==this.config.endDate){var s=this.config.endDate.clone().locale("en").set({minute:1!=this.config.minuteSteps?Math.round(this.config.endDate.minutes()/this.config.minuteSteps)*this.config.minuteSteps:this.config.endDate.minutes()}),o=s.hours(),l=s.minutes(),r=null;if(12==this.config.hourFormat){var c=s.format("hh mm a").split(" ");o=parseInt(c[0],10),r=c[2].toLowerCase()}this.setEndTimeValue(o,l,r)}}this.TimePickerOutOfLimitView()},setStartTimeValue:function(t,e,i){var n=this.timepickers.find(".calentim-timepicker-start"),a=n.find(".calentim-timepicker-hours");a.data("value",t);var s=a.data();s&&s.hasOwnProperty("value")&&(a.find(".calentim-hour-selected").text(this.localizeNumbers(("00"+s.value).slice(-2))),a.find(this.config.reverseTimepickerArrows?".calentim-hour-selected-next":".calentim-hour-selected-prev").text(this.localizeNumbers(s.value-s.step<s.min?("00"+s.max).slice(-2):("00"+(s.value-s.step)).slice(-2))),a.find(this.config.reverseTimepickerArrows?".calentim-hour-selected-prev":".calentim-hour-selected-next").text(this.localizeNumbers(s.value+s.step>s.max?("00"+s.min).slice(-2):("00"+(s.value+s.step)).slice(-2))));var o=n.find(".calentim-timepicker-minutes");o.data("value",e),(s=o.data())&&s.hasOwnProperty("value")&&(o.find(".calentim-minute-selected").text(this.localizeNumbers(("00"+s.value).slice(-2))),o.find(this.config.reverseTimepickerArrows?".calentim-minute-selected-next":".calentim-minute-selected-prev").text(this.localizeNumbers(s.value-s.step<s.min?("00"+s.max).slice(-2):("00"+(s.value-s.step)).slice(-2))),o.find(this.config.reverseTimepickerArrows?".calentim-minute-selected-prev":".calentim-minute-selected-next").text(this.localizeNumbers(s.value+s.step>s.max?("00"+s.min).slice(-2):("00"+(s.value+s.step)).slice(-2)))),null!==i&&(n.find(".calentim-ampm-selected").removeClass("calentim-ampm-selected"),n.find(".calentim-timepicker-ampm-"+i).addClass("calentim-ampm-selected"))},localizeAMPM:function(t){return moment("00:00 "+t,"HH:mm A").locale(this.config.locale).format("A")},localizeNumbers:function(t){return moment.localeData(this.config.locale).postformat(""+t)},setEndTimeValue:function(t,e,i){var n=this.timepickers.find(".calentim-timepicker-end"),a=n.find(".calentim-timepicker-hours");a.data("value",t);var s=a.data();s&&s.hasOwnProperty("value")&&(a.find(".calentim-hour-selected").text(this.localizeNumbers(("00"+s.value).slice(-2))),a.find(this.config.reverseTimepickerArrows?".calentim-hour-selected-next":".calentim-hour-selected-prev").text(this.localizeNumbers(s.value-s.step<s.min?("00"+s.max).slice(-2):("00"+(s.value-s.step)).slice(-2))),a.find(this.config.reverseTimepickerArrows?".calentim-hour-selected-prev":".calentim-hour-selected-next").text(this.localizeNumbers(s.value+s.step>s.max?("00"+s.min).slice(-2):("00"+(s.value+s.step)).slice(-2))));var o=n.find(".calentim-timepicker-minutes");o.data("value",e),(s=o.data())&&s.hasOwnProperty("value")&&(o.find(".calentim-minute-selected").text(this.localizeNumbers(("00"+s.value).slice(-2))),o.find(this.config.reverseTimepickerArrows?".calentim-minute-selected-next":".calentim-minute-selected-prev").text(this.localizeNumbers(s.value-s.step<s.min?("00"+s.max).slice(-2):("00"+(s.value-s.step)).slice(-2))),o.find(this.config.reverseTimepickerArrows?".calentim-minute-selected-prev":".calentim-minute-selected-next").text(this.localizeNumbers(s.value+s.step>s.max?("00"+s.min).slice(-2):("00"+(s.value+s.step)).slice(-2)))),null!==i&&(n.find(".calentim-ampm-selected").removeClass("calentim-ampm-selected"),n.find(".calentim-timepicker-ampm-"+i).addClass("calentim-ampm-selected"))},convertLimits:function(t){var e=moment("00:00","HH:mm"),i=moment("23:59","HH:mm");return t.hasOwnProperty("start")&&(e=t.start.hasOwnProperty("ampm")&&"string"==typeof t.start.ampm&&["am","pm"].indexOf(t.start.ampm.toLowerCase())>=0?moment(t.start.hour+":"+t.start.minute+" "+t.start.ampm.toLowerCase(),"h:m a"):moment(t.start.hour+":"+t.start.minute,"H m"),t.hasOwnProperty("end")&&(i=t.end.hasOwnProperty("ampm")&&"string"==typeof t.end.ampm&&["am","pm"].indexOf(t.end.ampm.toLowerCase())>=0?moment(t.end.hour+":"+t.end.minute+" "+t.end.ampm.toLowerCase(),"h:m a"):moment(t.end.hour+":"+t.end.minute,"H m"))),{start:{hour:e.hour(),minute:e.minute()},end:{hour:i.hour(),minute:i.minute()}}},fixLimits:function(t){var e=[{start:{hour:0,minute:0,ampm:null},end:{hour:23,minute:59,ampm:null}}];if(!t)return e;Array.isArray(t)||(t=[t]);var i;for(l=0,len=t.length;l<len;l++)if(0==(i=t[l],void 0,!0&&"object"==typeof i&&i.hasOwnProperty("start")&&i.hasOwnProperty("end")&&i.start.hasOwnProperty("hour")&&0==isNaN(i.start.hour)&&i.start.hasOwnProperty("minute")&&0==isNaN(i.start.minute)&&i.start.hasOwnProperty("ampm")&&("am"==i.start.ampm||"pm"==i.start.ampm||null==i.start.ampm)&&i.end.hasOwnProperty("hour")&&0==isNaN(i.end.hour)&&i.end.hasOwnProperty("minute")&&0==isNaN(i.end.minute)&&i.end.hasOwnProperty("ampm")&&("am"==i.end.ampm||"pm"==i.end.ampm||null==i.end.ampm)))return e;return t},TimeInsideLimits:function(t,e){direction="undefined"==typeof direction?"static":direction;for(var i=this.fixLimits(this.config.limitTimeForDay(t)),n=[],a=0,s=i.length;a<s;a++)if(n[a]=this.convertLimits(i[a]),n[a].startLimit=t.clone().hour(n[a].start.hour).minute(n[a].start.minute),n[a].endLimit=t.clone().hour(n[a].end.hour).minute(n[a].end.minute),t.isBetween(n[a].startLimit,n[a].endLimit,null,"[]"))return t;if("end"==e){for(a=0;a<s;a++)if(n[a].startLimit.isAfter(t))return n[a].startLimit;return n[0].startLimit}if(moment.isMoment(e)){for(a=0;a<s&&!e.isBetween(n[a].startLimit,n[a].endLimit,null,"[]");a++);return e.isAfter(t)?n[0==a?s-1:a-1].endLimit:n[a==s-1?0:a+1].startLimit}for(a=0;a<s;a++)if(n[a].endLimit.isBefore(t))return n[a].endLimit;return n[s-1].endLimit},TimePickerOutOfLimitView:function(){var t,e,i,n,a;this.config.startDate&&this.timepickers&&(t=this.config.startDate.clone(),i=this.convertLimits(this.config.limitTimeForDay(t.clone())),n=t.clone().hour(i.start.hour).minute(i.start.minute),a=t.clone().hour(i.end.hour).minute(i.end.minute),t.clone().add(1,"hour").isAfter(a,"hour")&&this.timepickers.find(".calentim-timepicker-start .calentim-timepicker-hours .calentim-hour-selected-next").html("&nbsp;"),t.clone().add(-1,"hour").isBefore(n,"hour")&&this.timepickers.find(".calentim-timepicker-start .calentim-timepicker-hours .calentim-hour-selected-prev").html("&nbsp;"),t.clone().add(1,"minute").isAfter(a,"minute")&&this.timepickers.find(".calentim-timepicker-start .calentim-timepicker-minutes .calentim-minute-selected-next").html("&nbsp;"),t.clone().add(-1,"minute").isBefore(n,"minute")&&this.timepickers.find(".calentim-timepicker-start .calentim-timepicker-minutes .calentim-minute-selected-prev").html("&nbsp;")),this.config.endDate&&this.timepickers&&(e=this.config.endDate.clone(),i=this.convertLimits(this.config.limitTimeForDay(e.clone())),n=e.clone().hour(i.start.hour).minute(i.start.minute),a=e.clone().hour(i.end.hour).minute(i.end.minute),e.clone().add(1,"hour").isAfter(a,"hour")&&this.timepickers.find(".calentim-timepicker-end .calentim-timepicker-hours .calentim-hour-selected-next").html("&nbsp;"),e.clone().add(-1,"hour").isBefore(n,"hour")&&this.timepickers.find(".calentim-timepicker-end .calentim-timepicker-hours .calentim-hour-selected-prev").html("&nbsp;"),e.clone().add(1,"minute").isAfter(a,"minute")&&this.timepickers.find(".calentim-timepicker-end .calentim-timepicker-minutes .calentim-minute-selected-next").html("&nbsp;"),e.clone().add(-1,"minute").isBefore(n,"minute")&&this.timepickers.find(".calentim-timepicker-end .calentim-timepicker-minutes .calentim-minute-selected-prev").html("&nbsp;"))},drawFooter:function(){if(!1===this.config.singleDate&&!0===this.config.showFooter&&!0===this.config.showCalendars){"horizontal"===this.config.rangeOrientation||this.globals.isMobile?this.input.append("<div class='calentim-ranges'></div>"):(this.input.addClass("calentim-input-vertical-range"),this.input.wrapInner("<div class='calentim-left'></div>"),t("<div class='calentim-right' style='max-width: "+this.config.verticalRangeWidth+"px; min-width: "+this.config.verticalRangeWidth+"px'><div class='calentim-ranges'></div></div>").insertAfter(this.input.find(".calentim-left")));var e=this.input.find(".calentim-ranges");for(var i in e.append("<span class='calentim-range-header-container'>"+this.config.rangeIcon+"<div class='calentim-range-header'>"+this.config.rangeLabel+"</div></span>"),this.config.ranges)e.append("<div class='calentim-range"+(this.config.ranges[i].selected?" calentim-range-selected":"")+"' data-id='"+i+"'>"+this.config.ranges[i].title+"</div>")}if(this.globals.isMobile&&(!0!==this.config.singleDate&&!1!==this.config.showFooter||this.input.append("<div class='calentim-filler'></div>")),(this.globals.isMobile&&!this.config.inline||!this.globals.isMobile&&!this.config.inline&&this.config.showButtons)&&("horizontal"===this.config.rangeOrientation||this.globals.isMobile?this.input.append("<div class='calentim-footer'></div>"):this.input.find(".calentim-right").append("<div class='calentim-footer'></div>"),this.footer=this.input.find(".calentim-footer"),this.footer.append("<button type='button' class='calentim-cancel'>"+this.config.cancelLabel+"</button>"),this.footer.append("<button type='button' class='calentim-apply'>"+this.config.applyLabel+"</button>"),!1===this.globals.firstValueSelected&&!0===this.config.startEmpty&&void 0!==this.footer||this.globals.isMobile&&!1===this.globals.endSelected)){var n=void 0===this.footer?[]:this.footer.find(".calentim-apply");n.length>0&&n.attr("disabled","disabled")}},drawNextMonth:function(t){if(t=t||e.event,1==this.config.hideOutOfRange&&this.config.maxDate&&this.globals.currentDate.clone().add(this.config.calendarCount,"month").isAfter(this.config.maxDate,"month"))return!1;if(null===this.globals.swipeTimeout){var i=this;this.globals.swipeTimeout=setTimeout(function(){if(!0===i.config.onbeforemonthchange(i,i.globals.currentDate?i.globals.currentDate.clone().startOfMonth():null,"next")){var t=i.calendars.get(0).scrollTop;i.globals.currentDate.middleOfDay().add(1,"month"),i.reDrawCalendars(),i.calendars.get(0).scrollTop=t,i.config.onaftermonthchange(i,i.globals.currentDate?i.globals.currentDate.clone().startOfMonth():null)}i.globals.swipeTimeout=null},"click"==t.type?0:100)}this.stopBubbling(t)},drawPrevMonth:function(t){if(t=t||e.event,1==this.config.hideOutOfRange&&this.config.minDate&&this.globals.currentDate.clone().add(-1,"month").isBefore(this.config.minDate,"month"))return!1;if(null===this.globals.swipeTimeout){var i=this;this.globals.swipeTimeout=setTimeout(function(){if(!0===i.config.onbeforemonthchange(i,i.globals.currentDate?i.globals.currentDate.clone().startOfMonth():null,"prev")){var t=i.calendars.get(0).scrollTop;i.globals.currentDate.middleOfDay().subtract(1,"month"),i.reDrawCalendars(),i.calendars.get(0).scrollTop=t,i.config.onaftermonthchange(i,i.globals.currentDate?i.globals.currentDate.clone().startOfMonth():null)}i.globals.swipeTimeout=null},100)}this.stopBubbling(t)},cellClicked:function(i){(i=i||e.event).target=i.target||i.srcElement,!1===t(i.target).hasClass("calentim-day")&&(i.target=t(i.target).closest(".calentim-day").get(0));var n=t(i.target).data("value"),a=moment.unix(n).middleOfDay();if(0==this.config.validateClick(a))return!1;if(!1===this.config.singleDate)if(!1===this.globals.startSelected){null!==this.config.startDate&&(this.globals.startDateBackup=this.config.startDate.clone()),this.config.startDate=a.clone(),this.config.endDate=null,this.globals.startSelected=!0,this.globals.endSelected=!1,this.readTimeFromDisplay(!1),a=this.config.startDate.clone(),this.config.startDate=this.TimeInsideLimits(this.config.startDate,"start"),!1===this.config.startDate.isSame(a)&&this.updateTimePickerDisplay();var s=void 0===this.footer?[]:this.footer.find(".calentim-apply");s.length>0&&s.attr("disabled","disabled"),this.config.onfirstselect(this,this.config.startDate.clone())}else{if(a.isBefore(this.config.startDate)){var o=this.config.startDate.clone();this.config.startDate=a.clone(),a=o}a.diff(this.config.startDate,"day")<this.config.minSelectedDays?(this.globals.startSelected=!1,this.fetchInputs()):(this.globals.startDateBackup=null,this.config.endDate=a.clone(),this.globals.endSelected=!0,this.globals.startSelected=!1,this.globals.hoverDate=null,this.readTimeFromDisplay(!1),a=this.config.endDate.clone(),this.config.endDate=this.TimeInsideLimits(this.config.endDate,"end"),!1===this.config.endDate.isSame(a)&&this.updateTimePickerDisplay(),!0===this.config.onbeforeselect(this,this.config.startDate?this.config.startDate.clone():null,this.config.endDate?this.config.endDate.clone():null)&&!0===this.checkRangeContinuity()?(this.globals.firstValueSelected=!0,this.clearRangeSelection(),this.updateInput(!0,!1)):this.fetchInputs(),this.config.autoCloseOnSelect&&!1===this.config.inline?this.hideDropdown(i):void 0!==this.footer&&null!==this.config.endDate&&this.footer.find(".calentim-apply").removeAttr("disabled"))}else this.config.startDate=a.clone(),this.config.endDate=this.config.startDate.clone(),this.globals.endSelected=!0,this.globals.startSelected=!1,this.globals.hoverDate=null,this.readTimeFromDisplay(),a=this.config.startDate.clone(),this.config.startDate=this.TimeInsideLimits(this.config.startDate,"start"),!1===this.config.startDate.isSame(a)&&this.updateTimePickerDisplay(),!0===this.config.onbeforeselect(this,this.config.startDate?this.config.startDate.clone():null,this.config.endDate?this.config.endDate.clone():null)?(this.globals.firstValueSelected=!0,this.clearRangeSelection(),this.updateInput(!0,!1)):this.fetchInputs(),this.config.autoCloseOnSelect&&!1===this.config.inline?this.hideDropdown(i):void 0!==this.footer&&null!==this.config.endDate&&this.footer.find(".calentim-apply").removeAttr("disabled");return this.input.is(":visible")&&(this.reDrawCells(),this.updateHeader()),this.stopBubbling(i),!1},checkRangeContinuity:function(){var t=this.config.endDate.diff(this.config.startDate,"days");if(this.config.singleDate||0==t)return!0;var e=moment(this.config.startDate).middleOfDay();if(1==this.config.disableOnlyStart)return!1===this.isDisabled(this.config.startDate,this.config.isHotelBooking);if(1==this.config.disableOnlyEnd)return!1===this.isDisabled(this.config.endDate,this.config.isHotelBooking);if(this.config.continuous){var i=e.middleOfDay().unix();if(1==this.isDisabled(i,!1)&&(!this.config.isHotelBooking||1===this.getDisabledLevel(i)))return!1;if(0==e.isSame(this.config.endDate,"day")){e.middleOfDay().add(1,"days");for(var n=0;n<=t-2;n++){if(i=e.middleOfDay().unix(),void 0!==this.getDisabledLevel(i))return!1;e.add(1,"days")}}if(i=e.middleOfDay().unix(),1==this.isDisabled(i,!1)&&(!this.config.isHotelBooking||3===this.getDisabledLevel(i)))return!1}return!0},isDisabledOnDraw:function(t){var e=moment(t).middleOfDay();if(!0===this.config.disableDays(e))return!0;for(var i=0;i<this.config.disabledRanges.length;i++){var n=this.config.disabledRanges[i];if(e.isBetween(n.start,n.end,"day","[]"))return!0}},isDisabled:function(t,e){return void 0===e&&(e=!1),(1!=this.config.disableOnlyStart||1!=this.globals.startSelected)&&((1!=this.config.disableOnlyEnd||0!=this.globals.startSelected)&&("object"==typeof t&&null!==t&&(t=t.clone().middleOfDay().unix()),e&&this.config.isHotelBooking?2===this.globals.disabledDays[t]:void 0!==this.globals.disabledDays[t]))},getDisabledLevel:function(t){return"object"==typeof t&&null!==t&&(t=t.clone().middleOfDay().unix()),this.globals.disabledDays[t]},cellHovered:function(i){(i=i||e.event).target=i.target||i.srcElement,!1===t(i.target).hasClass("calentim-day")&&(i.target=t(i.target).closest(".calentim-day").get(0));var n=t(i.target).data("value");this.globals.hoverDate=moment.unix(n).middleOfDay(),this.globals.keyboardHoverDate=null,!0===this.globals.startSelected&&this.reDrawCells(),this.stopBubbling(i)},reDrawCalendars:function(){this.backupTimePickers(),this.input.empty(),this.drawUserInterface(),this.restoreTimePickers(),this.container.focus()},monthSwitchClicked:function(){if(!(this.calendars.find(".calentim-month-selector").length>0)){var e=this;this.calendars.get(0).scrollTop=0;for(var i=t("<div class='calentim-month-selector'></div>").appendTo(this.calendars),n=this.globals.currentDate.get("month"),a=0;a<12;a++)i.append("<div class='calentim-ms-month"+(n==a?" current":"")+"' data-month='"+a+"'>"+(this.config.numericMonthSelector?a+1:moment({day:15,hour:12,month:a}).locale(this.config.locale).format(this.config.monthSwitcherFormat))+"</div>");i.css("display","block"),this.optimizeFontSize(i.find(".calentim-ms-month")),i.find(".calentim-ms-month").off("click").on("click",function(i){e.globals.currentDate.month(t(this).data("month")),e.config.onaftermonthchange(e,e.globals.currentDate?e.globals.currentDate.clone().startOfMonth():null),e.calendars.find(".calentim-month-selector").remove(),e.reDrawCalendars(),e.stopBubbling(i)})}},yearSwitchClicked:function(){if(!(this.calendars.find(".calentim-year-selector").length>0)){var e=this;this.calendars.get(0).scrollTop=0;var n=t("<div class='calentim-year-selector'></div>").appendTo(this.calendars),a=this.globals.currentDate.get("year");n.append("<div class='calentim-ys-year-prev'><i class='fa fa-angle-double-left'></i></div>"),n.data("year",a);for(var s=a-6;s<a+7;s++)n.append("<div class='calentim-ys-year"+(a==s?" current":"")+"' data-year='"+s+"'>"+s+"</div>");n.append("<div class='calentim-ys-year-next'><i class='fa fa-angle-double-right'></i></div>"),n.css("display","block"),this.optimizeFontSize(n.find(".calentim-ys-year")),t(i).off("click.calentimys").on("click.calentimys",".calentim-ys-year",function(i){e.globals.currentDate.year(t(this).data("year")),e.config.onafteryearchange(e,e.globals.currentDate?e.globals.currentDate.clone().startOf("year"):null),e.reDrawCalendars(),e.calendars.find(".calentim-year-selector").remove(),1==e.config.DOBCalendar&&e.calendars.find(".calentim-calendar").first().find(".calentim-month-switch").click(),e.stopBubbling(i)}),t(i).off("click.calentimysprev").on("click.calentimysprev",".calentim-ys-year-prev",function(t){var i=n.data("year")-13,a=e.globals.currentDate.get("year");n.data("year",i),n.empty(),n.append("<div class='calentim-ys-year-prev'><i class='fa fa-angle-double-left'></i></div>");for(var s=i-6;s<i+7;s++)n.append("<div class='calentim-ys-year"+(a==s?" current":"")+"' data-year='"+s+"'>"+s+"</div>");n.append("<div class='calentim-ys-year-next'><i class='fa fa-angle-double-right'></i></div>"),e.stopBubbling(t)}),t(i).off("click.calentimysnext").on("click.calentimysnext",".calentim-ys-year-next",function(t){var i=n.data("year")+13,a=e.globals.currentDate.get("year");n.data("year",i),n.empty(),n.append("<div class='calentim-ys-year-prev'><i class='fa fa-angle-double-left'></i></div>");for(var s=i-6;s<i+7;s++)n.append("<div class='calentim-ys-year"+(a==s?" current":"")+"' data-year='"+s+"'>"+s+"</div>");n.append("<div class='calentim-ys-year-next'><i class='fa fa-angle-double-right'></i></div>"),e.stopBubbling(t)})}},optimizeFontSize:function(i){i.each(function(i,n){(n=t(n)).wrapInner("<span class='adjust-subject'></span>").prepend("<span class='font-adjuster'>i</span>");var a=n.find(".adjust-subject"),s=n.find(".font-adjuster");if(a.innerHeight()===s.innerHeight())s.remove(),a.contents().unwrap();else{for(var o=0;a.innerHeight()!==s.innerHeight()&&o<16;){var l=0;if(l=void 0!==e.getComputedStyle?parseFloat(e.getComputedStyle(s.get(0),null).getPropertyValue("font-size")):parseFloat(s.css("font-size")),a.parent().css("font-size",l-1+"px"),s.css("font-size",l-1+"px"),l<2)break;o++}s.remove(),a.contents().unwrap()}})},showDropdown:function(n){var a=n||e.event||jQuery.Event("click",{target:this.elem}),s=a.target||a.srcElement;return(!this.globals.isMobile&&"none"==this.container.css("display")||this.globals.isMobile&&"none"==this.input.css("display"))&&(s!==this.elem&&(this.globals.dontHideOnce=!0,this.globals.initiator=s),null!==this.config.startDate&&(this.globals.startDateInitial=this.config.startDate.clone()),null!==this.config.endDate&&(this.globals.endDateInitial=this.config.endDate.clone()),this.fetchInputs(),(!1===this.config.startEmpty||this.globals.firstValueSelected)&&(this.globals.currentDate=moment(this.config.startDate)),0==this.globals.currentDate.isValid()&&(this.globals.currentDate=moment().locale(this.config.locale).middleOfDay()),this.config.onbeforeshow(this),this.globals.isMobile?(this.input.css({display:"flex"}),this.config.inline||this.overlay.show(),t("body").addClass("calentim-open")):this.container.css({display:"block"}),this.globals.lastScrollY=e.scrollY||e.pageYOffset||i.documentElement.scrollTop,this.reDrawCalendars(),1==this.config.DOBCalendar&&this.calendars.find(".calentim-calendar").first().find(".calentim-year-switch").click(),this.config.onaftershow(this)),!1},hideDropdown:function(i){var n=i||e.event||jQuery.Event("click",{target:"body"}),a=n.target||n.srcElement;if(this.globals.initiator!==a)return!1===this.config.inline&&(!this.globals.isMobile&&"none"!==this.container.css("display")||this.globals.isMobile&&"none"!==this.input.css("display"))&&(this.config.onbeforehide(this),this.globals.isMobile?(this.input.css({display:"none"}),t("body").removeClass("calentim-open"),this.config.inline||this.overlay.hide()):this.container.css({display:"none"}),this.globals.hoverDate=null,null!==this.globals.startDateBackup&&(this.config.startDate=this.globals.startDateBackup,this.globals.startSelected=!1),this.config.onafterhide(this)),!1},reDrawCells:function(){var e=null!==this.config.startDate?this.config.startDate.clone().middleOfDay().unix():null,i=null!==this.config.endDate?this.config.endDate.clone().middleOfDay().unix():null,n=null!==this.config.minDate?this.config.minDate.clone().middleOfDay().unix():null,a=null!==this.config.maxDate?this.config.maxDate.clone().middleOfDay().unix():null,s=null!==this.globals.hoverDate?this.globals.hoverDate.clone().middleOfDay().unix():null,o=null!==this.globals.keyboardHoverDate?this.globals.keyboardHoverDate.clone().middleOfDay().unix():null,l=moment().middleOfDay().unix();this.lastHoverStatus=!1;for(var r=0;r<this.config.calendarCount;r++)for(var c=this.calendars.find(".calentim-calendar").eq(r),h=c.find(".calentim-days-container > div").not(".calentim-dayofweek, .calentim-weeknumber"),d=c.data("month"),m=0;m<h.length;m++){var f=t(h[m]),u=parseInt(f.attr("data-value")),g=moment.unix(u).middleOfDay().locale(this.config.locale),p="calentim-day",b=g.day();6!=b&&0!==b||(p+=" calentim-weekend"),u===l&&(p+=" calentim-today"),p=this.addDisabledStyles(f,g,u,p,n,a,d),p=this.addSelectedStyles(u,p,e,i,n,a),p=this.addHoverStyles(f,u,p,this,e,s,o),f.attr("class",p)}this.attachEvents(),this.config.ondraw(this)},addSelectedStyles:function(t,e,i,n,a,s){return(!1===this.config.startEmpty||this.globals.firstValueSelected)&&(!1===this.config.singleDate&&null!==i&&i===t&&(e+=" calentim-start"),!1===this.config.singleDate&&null!==n&&n===t&&(e+=" calentim-end"),!1===this.config.singleDate&&null!==i&&null!==n&&t<=n&&t>=i&&(e+=" calentim-selected"),!0===this.config.singleDate&&null!==i&&i===t&&(e+=" calentim-selected calentim-start calentim-end")),e},addHoverStyles:function(t,e,i,n,a,s,o){return i.replace("calentim-hovered","").replace("calentim-hovered-last","").replace("calentim-hovered-first",""),!0===this.globals.startSelected&&!1===this.globals.endSelected&&null!==s&&(e>=s&&e<=a||e<=s&&e>=a)&&(i+=" calentim-hovered"),!0===this.config.enableKeyboard&&null!==o&&(!1===this.globals.startSelected?o==e&&(i+=" calentim-hovered"):(e<=a&&e>=o||e>=a&&e<=o)&&(i+=" calentim-hovered")),!1===this.lastHoverStatus&&i.indexOf("calentim-hovered")>0&&(this.lastHoverStatus=!0,i+=" calentim-hovered-first"),!0===this.lastHoverStatus&&i.indexOf("calentim-hovered")<0&&(t.prev(".calentim-day").addClass("calentim-hovered-last"),this.lastHoverStatus=!1),i},addDisabledStyles:function(t,e,i,n,a,s,o){if(this.isDisabled(i))if(0==this.config.isHotelBooking)n=n.replace("calentim-day","calentim-disabled calentim-disabled-range");else switch(this.globals.disabledDays[i]){case 1:n=n.replace("calentim-day","calentim-day calentim-disabled-range calentim-disabled-range-start");break;case 2:n=n.replace("calentim-day","calentim-disabled calentim-disabled-range");break;case 3:n=n.replace("calentim-day","calentim-day calentim-disabled-range calentim-disabled-range-end")}else(null!=s&&i>s||null!=a&&i<a)&&(n=n=n.replace("calentim-day","calentim-disabled"));return e.month()!=o&&(n+=" calentim-not-in-month"),n},rangeClicked:function(i){if((i=i||e.event).target=i.target||i.srcElement,!1===t(i.target).hasClass("calentim-range")&&(i.target=t(i.target).closest(".calentim-range").get(0)),i.target.hasAttribute("data-id")){var n=t(i.target).attr("data-id");return this.globals.currentDate=this.config.ranges[n].startDate.clone().locale(this.config.locale),this.config.startDate=this.config.ranges[n].startDate.clone().locale(this.config.locale),this.config.endDate=this.config.ranges[n].endDate.clone().locale(this.config.locale),this.globals.firstValueSelected=!0,!1===this.checkRangeContinuity()?this.fetchInputs():(this.clearRangeSelection(),this.config.ranges[n].selected=!0,this.updateTimePickerDisplay(),this.reDrawCalendars(),this.setViewport(),this.config.onrangeselect(this,this.config.ranges[n]),this.config.autoCloseOnSelect&&this.hideDropdown()),this.stopBubbling(i),!1}},setViewport:function(){if(!0===this.globals.isMobile)"none"!==this.input.css("display")&&this.container.trigger("calentim:resize");else{if("none"!==this.container.css("display")&&this.globals.initComplete&&!1===this.globals.isMobile&&!1===this.config.inline){var t=this.getViewport();switch(this.config.showOn){case"top":this.config.autoAlign?this.positionOnTopAlign(t):this.positionOnTop(!1,t),this.horizontalAlign(t);break;case"left":this.config.autoAlign?this.positionOnLeftAlign(t):this.positionOnLeft(!1,t),this.verticalAlign(t);break;case"right":this.config.autoAlign?this.positionOnRightAlign(t):this.positionOnRight(!1,t),this.verticalAlign(t);break;case"bottom":this.config.autoAlign?this.positionOnBottomAlign(t):this.positionOnBottom(!1,t),this.horizontalAlign(t);break;case"center":this.positionOnCenter(t);break;default:this.config.autoAlign?this.positionOnBottomAlign(t):this.positionOnBottom(!1,t),this.horizontalAlign(t)}}if("horizontal"!==this.config.rangeOrientation){var e=this.input.find(".calentim-header").outerHeight()+this.input.find(".calentim-calendars").outerHeight()+(this.input.find(".calentim-footer").length>0?this.input.find(".calentim-footer").outerHeight():0)+(this.input.find(".calentim-timepickers").length>0?this.input.find(".calentim-timepickers").outerHeight():0);this.input.find(".calentim-right").css("max-height",e)}}},getDropdownPos:function(t){var e=this.getDimensions(this.$elem,!0),i=this.getDimensions(this.container,!0),n=parseInt(this.input.css("margin-left"),10),a=parseFloat(this.container.find("div[class*='calentim-box-arrow']").first().outerHeight()/2);switch(t){case"left":switch(this.config.arrowOn){case"top":return{top:e.offsetTop-n-a-e.height/2,left:e.offsetLeft-i.width-n,arrow:0};case"center":return{top:e.offsetTop-n-i.height/2,left:e.offsetLeft-i.width-n,arrow:(i.height-2*a)/2-e.height/2};case"bottom":return{top:e.offsetTop-i.height+e.height+2*n+a,left:e.offsetLeft-i.width-n,arrow:i.height-4*a-3*n-e.height/2};default:return{top:e.offsetTop-n-a-e.height/2,left:e.offsetLeft-i.width-n,arrow:0}}break;case"right":switch(this.config.arrowOn){case"top":return{top:e.offsetTop-n-a-e.height/2,left:e.offsetLeft+e.width+n,arrow:0};case"center":return{top:e.offsetTop-n-i.height/2,left:e.offsetLeft+e.width+n,arrow:(i.height-2*a)/2-e.height/2};case"bottom":return{top:e.offsetTop-i.height+e.height+2*n+a,left:e.offsetLeft+e.width+n,arrow:i.height-4*a-3*n-e.height/2};default:return{top:e.offsetTop-n-a-e.height/2,left:e.offsetLeft+e.width+n,arrow:0}}break;case"top":switch(this.config.arrowOn){case"left":return{top:e.offsetTop-i.height-n,left:e.offsetLeft-n,arrow:0};case"center":return{top:e.offsetTop-i.height-n,left:e.offsetLeft-(i.width-2*n-e.width)/2,arrow:(i.width-5*a)/2};case"right":return{top:e.offsetTop-i.height-n,left:e.offsetLeft-(i.width-e.width)+n,arrow:i.width-5*a+n};default:return{top:e.offsetTop-i.height-n,left:e.offsetLeft-n,arrow:0}}break;case"bottom":switch(this.config.arrowOn){case"left":return{top:e.offsetTop+e.height-n+a,left:e.offsetLeft-n,arrow:0};case"center":return{top:e.offsetTop+e.height-n+a,left:e.offsetLeft-(i.width-2*n-e.width)/2,arrow:(i.width-5*a)/2};case"right":return{top:e.offsetTop+e.height-n+a,left:e.offsetLeft-(i.width-e.width)+n,arrow:i.width-5*a+n};default:return{top:e.offsetTop+e.height-n+a,left:e.offsetLeft-n,arrow:0}}break;case"center":switch(this.config.arrowOn){case"center":return{top:e.offsetTop-n-i.height/2,left:e.offsetLeft-(i.width-2*n-e.width)/2}}}},verticalAlign:function(e){var i=this.getDimensions(this.container,!0),n=e.top-i.offsetTop,a=i.offsetTop+i.height-e.bottom;n>0&&Math.abs(n)<i.height?(this.container.css({top:function(){return parseFloat(t(this).css("top").replace(/px$/,""))+n}}),this.container.find("div[class*='calentim-box-arrow-']").css({top:function(){return parseFloat(t(this).css("top").replace(/px$/,""))-n}})):a>0&&Math.abs(a)<i.height&&(this.container.css({top:function(){return parseFloat(t(this).css("top").replace(/px$/,""))-a}}),this.container.find("div[class*='calentim-box-arrow-']").css({top:function(){return parseFloat(t(this).css("top").replace(/px$/,""))+a}}))},horizontalAlign:function(e){var i=this.getDimensions(this.container,!0),n=i.offsetLeft+i.width-e.right;n>0&&Math.abs(n)<i.width&&(this.container.css({left:function(){return parseFloat(t(this).css("left").replace(/px$/,""))-n}}),this.container.find("div[class*='calentim-box-arrow-']").css({left:function(){return parseFloat(t(this).css("left").replace(/px$/,""))+n}}))},positionOnTop:function(t,e){var i=this.getDropdownPos("top");if(t)return i;this.container.css({left:i.left,top:i.top}),this.container.find("div[class*='calentim-box-arrow-']").css({left:i.arrow}).attr("class","calentim-box-arrow-bottom")},positionOnBottom:function(t,e){var i=this.getDropdownPos("bottom");if(t)return i;this.container.css({left:i.left,top:i.top}),this.container.find("div[class*='calentim-box-arrow-']").attr("class","calentim-box-arrow-top").css({left:i.arrow})},positionOnLeft:function(t,e){var i=this.getDropdownPos("left");if(t)return i;this.container.css({left:i.left,top:i.top+11}),this.container.children("div[class*='calentim-box-arrow-']").attr("class","calentim-box-arrow-right").css({top:i.arrow})},positionOnRight:function(t,e){var i=this.getDropdownPos("right");if(t)return i;this.container.css({left:i.left,top:i.top+11}),this.container.children("div[class*='calentim-box-arrow-']").attr("class","calentim-box-arrow-left").css({top:i.arrow})},positionOnCenter:function(t){var e=this.getDropdownPos("center"),i=Math.max(e.left+this.container[0].clientWidth-(t.right-30),0),n=Math.max(e.top+this.container[0].clientHeight-(t.bottom-30),0);this.config.autoAlign||(i=0,n=0),e.left-=i,e.top-=n,this.container.css({left:e.left,top:e.top}),this.container.find("div[class*='calentim-box-arrow-']").remove()},positionOnBottomAlign:function(t){var e=this.positionOnBottom(!0,t),i=this.getDimensions(this.container);e.top+i.height<t.bottom?this.positionOnBottom(!1,t):this.positionOnTop(!1,t)},positionOnLeftAlign:function(t){this.positionOnLeft(!0,t).left>t.left-50?this.positionOnLeft(!1,t):this.positionOnRight(!1,t)},positionOnRightAlign:function(t){var e=this.positionOnRight(!0,t),i=this.getDimensions(this.container);e.left+i.width<t.right+50?this.positionOnRight(!1,t):this.positionOnLeft(!1,t)},positionOnTopAlign:function(t){this.positionOnTop(!0,t).top>t.top?this.positionOnTop(!1,t):this.positionOnBottom(!1,t)},getDimensions:function(e,n){var a=i.body,s=e[0],o=e.offset();if(e===this.$elem&&!1===this.globals.parentScrollEventsAttached){var l=t.proxy(function(){this.globals.isTicking||(this.globals.isTicking=!0,this.globals.rafID=this.requestAnimFrame(t.proxy(function(){this.setViewport(),this.cancelAnimFrame(this.globals.rafID),this.globals.isTicking=!1},this)))},this);if(s!==a)for(var r=s.parentNode;r!==a&&null!==r;)r.scrollHeight>r.offsetHeight&&t(r).off("scroll.calentim").on("scroll.calentim",l),r=r.parentNode;this.globals.parentScrollEventsAttached=!0}return{width:s.offsetWidth,height:s.offsetHeight,offsetLeft:o.left,offsetTop:o.top}},getViewport:function(){var t=this.globals.lastScrollY,i=this.globals.lastScrollX,n=t+e.innerHeight;return{top:t,left:i,right:i+e.innerWidth,bottom:n}},attachEvents:function(){var e=t.proxy(this.drawNextMonth,this),i=t.proxy(this.drawPrevMonth,this),n=t.proxy(this.cellClicked,this),a=t.proxy(this.cellHovered,this),s=t.proxy(this.rangeClicked,this),o=t.proxy(this.monthSwitchClicked,this),l=t.proxy(this.yearSwitchClicked,this),r="click.calentim";if(this.container.find(".calentim-next").off(r).one(r,e),this.container.find(".calentim-prev").off(r).one(r,i),this.container.find(".calentim-day").off(r).on(r,n),this.container.find(".calentim-day").off("mouseover.calentim").on("mouseover.calentim",a),this.container.find(".calentim-disabled").not(".calentim-day").off(r),this.container.find(".calentim-range").off(r).on(r,s),this.container.find(".calentim-month-switch ").off(r).on(r,o),this.container.find(".calentim-year-switch ").off(r).on(r,l),!0===this.globals.isMobile&&1==this.config.enableSwipe)if("function"==typeof t.fn.swiperight)this.input.find(".calentim-calendars").css("touch-action","none"),this.input.find(".calentim-calendars").on("swipeleft",e),this.input.find(".calentim-calendars").on("swiperight",i);else{var c=new Hammer(this.input.find(".calentim-calendars").get(0));c.off("swipeleft").on("swipeleft",e),c.off("swiperight").on("swiperight",i)}!this.globals.isMobile&&!this.config.showButtons||this.config.inline||(this.input.find(".calentim-cancel").off("click.calentim").on("click.calentim",t.proxy(function(t){1==this.config.onCancel(this,this.config.startDate,this.config.endDate)&&(this.config.startDate=this.globals.startDateInitial?this.globals.startDateInitial.clone():null,this.config.endDate=this.globals.endDateInitial?this.globals.endDateInitial.clone():null,this.config.startEmpty&&!this.globals.startDateInitial&&this.clearInput(),this.updateTimePickerDisplay(),this.updateInput(!1,!1),this.hideDropdown(t))},this)),this.input.find(".calentim-apply").off("click.calentim").on("click.calentim",t.proxy(function(t){this.config.startDate=this.config.startDate||moment(),this.config.endDate=this.config.endDate||moment(),!0===this.config.onbeforeselect(this,this.config.startDate.clone(),this.config.endDate.clone())&&!0===this.checkRangeContinuity()?(this.globals.firstValueSelected=!0,this.globals.delayInputUpdate?(this.globals.delayInputUpdate=!1,this.updateInput(!0,!1),this.clearRangeSelection(),this.globals.delayInputUpdate=!0):this.updateInput(!0,!1)):this.fetchInputs(),this.hideDropdown(t)},this)))},addInitialEvents:function(){var n=this,a="click.calentim";this.globals.documentEvent=a+"_"+Math.round((new Date).getTime()+100*Math.random()),t(i).on(this.globals.documentEvent,t.proxy(function(i){if(!1===this.globals.isMobile&&!1===this.config.inline){var n=i||e.event||jQuery.Event("click",{target:"body"}),a=n.target||n.srcElement;0===t(this.container).find(t(a)).length&&this.elem!==a&&this.container.is(":visible")>0&&this.hideDropdown(n)}},this)),this.config.enableKeyboard&&(a="click.calentim focus.calentim"),this.$elem.off(a).on(a,t.proxy(this.debounce(function(n){var a=n||e.event||jQuery.Event("click",{target:"body"}),s=a.target||a.srcElement;this.input.get(0).clientHeight>0&&this.config.target.get(0)!==s?this.hideDropdown(a):(t(i).trigger("click"),this.showDropdown(a))},200,!0),this)),this.globals.isMobile&&t(e).on("resize.calentim",t.proxy(function(t){this.container.trigger("calentim:resize")},this)),this.container.on("calentim:resize",t.proxy(function(){this.globals.rafID=this.requestAnimFrame(function(){if(n.config.showCalendars){var i=n.input.find(".calentim-calendar:visible:first").innerHeight();n.input.removeClass("calentim-input-top-reset"),n.input.position().top<0&&n.input.addClass("calentim-input-top-reset"),t(e).width()>t(e).height()?(n.input.find(".calentim-calendars").css({maxHeight:99999,minHeight:i}),"flex"===n.input.css("display")&&(n.input.find(".calentim-header:visible").length>0?n.input.css("height",i+n.input.find(".calentim-header").outerHeight()+2+"px"):n.input.css("height",i+2+"px"))):(n.input.css("height","auto"),n.input.find(".calentim-calendars").css({maxHeight:i,minHeight:0}))}else n.input.css("height","auto");n.updateTimePickerDisplay(),n.cancelAnimFrame(n.globals.rafID)})},this)),"none"!==this.input.css("display")&&this.globals.isMobile&&this.container.trigger("calentim:resize"),!1===this.globals.isMobile&&t(e).on("resize.calentim scroll.calentim",function(){n.globals.isTicking||(n.globals.isTicking=!0,n.globals.lastScrollX=e.scrollX||e.pageXOffset||i.documentElement.scrollLeft,n.globals.lastScrollY=e.scrollY||e.pageYOffset||i.documentElement.scrollTop,n.globals.rafID=n.requestAnimFrame(t.proxy(function(){this.setViewport(),this.globals.isTicking=!1,this.cancelAnimFrame(this.globals.rafID)},n)))})},stopBubbling:function(t){return"function"==typeof t.stopPropagation?t.stopPropagation():void 0!==t.cancelBubble&&(t.cancelBubble=!0),"function"==typeof t.preventDefault&&t.preventDefault(),t.returnValue=!1,!1},debounce:function(t,e,i){return function(){var n=this,a=arguments,s=i&&!n.globals.throttleTimeout;clearTimeout(n.globals.throttleTimeout),n.globals.throttleTimeout=setTimeout(function(){n.globals.throttleTimeout=null,i||t.apply(n,a)},e),s&&t.apply(n,a)}},requestAnimFrame:function(t){return"function"==typeof e.requestAnimationFrame?requestAnimationFrame(t):"function"==typeof e.webkitRequestAnimationFrame?webkitRequestAnimationFrame(t):"function"==typeof e.mozRequestAnimationFrame?mozRequestAnimationFrame(t):setTimeout(t,100/6)},cancelAnimFrame:function(t){return"function"==typeof e.cancelAnimationFrame?cancelAnimationFrame(t):"function"==typeof e.webkitCancelAnimationFrame?webkitCancelAnimationFrame(t):"function"==typeof e.mozCancelAnimationFrame?mozCancelAnimationFrame(t):clearTimeout(t)},addKeyboardEvents:function(){if(this.config.enableKeyboard&&this.config.showCalendars){var e=t.proxy(function(t){var e=t.which?t.which:t.keyCode;null===this.globals.keyboardHoverDate?null===this.config.startDate?this.globals.keyboardHoverDate=moment({day:1,month:this.calendars.first().data("month")}).middleOfDay():this.globals.keyboardHoverDate=this.config.startDate.clone().middleOfDay():this.globals.keyboardHoverDate.middleOfDay();var i=!1,n=!1;switch(e){case 37:this.globals.keyboardHoverDate.add(-1,"day"),i=!0,n=!0;break;case 38:this.globals.keyboardHoverDate.add(-1,"week"),i=!0,n=!0;break;case 39:this.globals.keyboardHoverDate.add(1,"day"),i=!0,n=!0;break;case 40:this.globals.keyboardHoverDate.add(1,"week"),i=!0,n=!0;break;case 32:this.input.find(".calentim-day[data-value='"+this.globals.keyboardHoverDate.middleOfDay().unix()+"']").first().trigger("click.calentim"),i=!1,n=!0;break;case 33:t.shiftKey?this.globals.keyboardHoverDate.add(-1,"years"):this.globals.keyboardHoverDate.add(-1,"months"),i=!0,n=!0;break;case 34:t.shiftKey?this.globals.keyboardHoverDate.add(1,"years"):this.globals.keyboardHoverDate.add(1,"months"),i=!0,n=!0;break;case 27:this.hideDropdown(t);break;case 36:t.shiftKey&&(this.globals.keyboardHoverDate=moment().middleOfDay(),i=!0,n=!0)}if(i||n)return this.globals.keyboardHoverDate=this.globals.keyboardHoverDate.middleOfDay(),(this.globals.keyboardHoverDate.isBefore(moment.unix(this.input.find(".calentim-day:first").attr("data-value")),"minute")||this.globals.keyboardHoverDate.isAfter(moment.unix(this.input.find(".calentim-day:last").attr("data-value")),"minute"))&&(this.globals.currentDate=this.globals.keyboardHoverDate.clone().startOfMonth(),this.reDrawCalendars(),i=!1),i&&(this.globals.hoverDate=null,this.reDrawCells()),n&&this.stopBubbling(t),this.container.find(".calentim-calendars").focus(),!1},this);this.$elem.off("keydown.calentim").on("keydown.calentim",t.proxy(function(t){var e=t.which?t.which:t.keyCode;return 9==e&&0==t.shiftKey&&0==this.globals.skipTabKeyOnInput?(this.container.find(".calentim-calendars").focus(),!1):(9==e&&0==t.shiftKey&&(this.globals.skipTabKeyOnInput=!1),!0)},this)),this.container.find(".calentim-calendars").off("keydown.calentim").on("keydown.calentim",e),this.timepickers.find(".calentim-timepicker-ampm").off("keydown.calentim").on("keydown.calentim",function(e){var i=e.which?e.which:e.keyCode,n=e.target||e.currentTarget,a=t(n).parent().hasClass("calentim-timepicker-end");switch(i){case 38:case 40:return t(n).children(":not(.calentim-ampm-selected)").click(),!1;case 9:if(a&&0==e.shiftKey){var s=t(n).closest(".calentim-container").data("calentim");s&&(s.globals.skipTabKeyOnInput=!0,s.hideDropdown(),s.$elem.focus().trigger(t.Event("keydown.calentim",{keyCode:9,which:9})))}}return!0}),this.timepickers.find(".calentim-timepicker-minutes-wrapper").off("keydown.calentim").on("keydown.calentim",function(e){var i=e.which?e.which:e.keyCode,n=e.target||e.currentTarget;switch(i){case 38:return t(n).siblings(".calentim-timepicker-minute-arrows").find(".calentim-timepicker-minutes-up").click(),!1;case 40:return t(n).siblings(".calentim-timepicker-minute-arrows").find(".calentim-timepicker-minutes-down").click(),!1}return!0}),this.timepickers.find(".calentim-timepicker-hours-wrapper").off("keydown.calentim").on("keydown.calentim",function(e){var i=e.which?e.which:e.keyCode,n=e.target||e.currentTarget;switch(i){case 38:return t(n).siblings(".calentim-timepicker-hour-arrows").find(".calentim-timepicker-hours-up").click(),!1;case 40:return t(n).siblings(".calentim-timepicker-hour-arrows").find(".calentim-timepicker-hours-down").click(),!1}return!0})}},destroy:function(){this.config.onBeforeDestroy(this)&&(this.config.inline?(this.input.remove(),this.globals.isMobile?this.$elem.unwrap(".calentim-container-mobile"):this.$elem.unwrap(".calentim-container"),this.elem.type="text"):this.container.remove(),t(i).off(this.globals.documentEvent),this.$elem.removeData("calentim"),this.config.ondestroy(this))},fixDateTime:function(t){return null!=t&&0==moment.isMoment(t)&&(t="string"==typeof t?moment(t,this.config.format).locale(this.config.locale):moment(t).locale(this.config.locale)),t},checkMobile:function(){return e.matchMedia("only screen and (max-width: "+this.config.mobileBreakpoint+"px)").matches},checkTouch:function(){var t=" -webkit- -moz- -o- -ms- ".split(" ");return!!("ontouchstart"in e||e.DocumentTouch&&i instanceof DocumentTouch)||function(t){return e.matchMedia(t).matches}(["(",t.join("touch-enabled),("),"heartz",")"].join(""))},setStart:function(t){var e=this.fixDateTime(t);!1===this.isDisabled(e)&&moment(e).isValid()&&(this.config.startDate=moment(e),this.config.singleDate&&(this.config.endDate=moment(e)),this.refreshValues())},setEnd:function(t){var e=this.fixDateTime(t);!1===this.isDisabled(e)&&moment(e).isValid()&&(this.config.endDate=moment(e),this.refreshValues())},setMinDate:function(t){var e=this.fixDateTime(t);moment(e).isValid()&&(this.config.minDate=moment(e),this.refreshValues())},setMaxDate:function(t){var e=this.fixDateTime(t);moment(e).isValid()&&(this.config.maxDate=moment(e),this.refreshValues())},setDisplayDate:function(t){var e=this.fixDateTime(t);moment(e).isValid()&&(this.globals.currentDate=moment(e),this.reDrawCalendars())},refreshValues:function(){var t=this.globals.delayInputUpdate;this.globals.delayInputUpdate=!1,this.validateDates(),this.updateTimePickerDisplay(),this.updateInput(),this.globals.delayInputUpdate=t,this.reDrawCells()}}).defaults,t.fn.calentim=function(e){return this.each(function(){null==t(this).data("calentim")&&new a(this,e).init()})},"function"!=typeof moment.fn.middleOfDay&&(moment.fn.middleOfDay=function(){return this.hours(12).minutes(0).seconds(0),this},moment.fn.startOfMonth=function(){return this.middleOfDay().date(1),this})}(jQuery,window,document);